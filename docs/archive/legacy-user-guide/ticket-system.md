# 🎫 票券系統

> 全功能的客服與支援票券管理系統

## 📋 系統概覽

Potato Bot 的票券系統提供一套完整的解決方案，用於管理用戶的支援請求、問題回報和一般查詢。它旨在簡化溝通流程，提高客服效率，並確保每個請求都能得到及時處理。

### 核心特色

*   **多渠道創建**：用戶可透過 Discord 指令或 Web 介面創建票券。
*   **專屬頻道**：每個票券都會創建一個獨立的 Discord 頻道，確保對話的私密性和集中性。
*   **智能管理**：支援優先級設定、自動指派、標籤分類和 SLA 監控。
*   **自動化流程**：自動關閉無活動票券、成員離開自動處理等。
*   **數據分析**：提供豐富的統計報告和實時監控，幫助團隊優化服務。
*   **API 整合**：提供 RESTful API 供外部系統整合。

## 🚀 快速開始

### 1. 設置票券面板

管理員可以使用 `!setup_ticket` 指令在指定頻道建立一個票券創建面板。用戶可以點擊面板上的按鈕來創建新票券。

```
!setup_ticket
```

### 2. 設定票券分類頻道

為了更好地組織票券，建議設定一個分類頻道，所有新票券頻道將會在此分類下建立。

```
!set_ticket_category #你的分類頻道名稱
```

### 3. 設定客服角色

確保您的客服人員擁有正確的角色，以便他們可以查看和管理票券。這些角色需要在票券系統設定中配置。

## 🎮 用戶指南

### 創建票券

當您遇到問題或有疑問時，可以透過票券面板創建一個新的支援請求。

1.  **點擊票券面板上的按鈕**：在管理員設置的票券面板中，點擊相應的按鈕（例如「技術支援」、「一般查詢」）。
2.  **填寫必要資訊**：系統會引導您提供問題的標題和詳細描述。
3.  **專屬頻道**：票券創建後，系統會自動為您創建一個專屬的 Discord 頻道。您可以在此頻道中與客服人員溝通。

### 查看我的票券

您可以隨時查看您自己創建的票券列表和狀態。

```
/my_tickets [status: open|closed|all]
```

### 查看票券資訊

在票券頻道中，您可以查看當前票券的詳細資訊。

```
/ticket_info
```

### 關閉票券

當您的問題解決後，您可以關閉票券。

```
/close [reason: 關閉原因]
```

## 👨‍💼 管理員與客服指南

### 票券列表與篩選

客服人員可以查看所有票券的列表，並根據狀態、用戶、優先級或標籤進行篩選。

```
/tickets [status: open|closed|all] [user: @用戶] [priority: high|medium|low|all] [tag: 標籤名稱]
```

### 票券指派

您可以手動指派票券給特定的客服人員，或使用自動指派功能。

*   **手動指派**：
    ```
    !assign_ticket <ticket_id> @客服人員
    ```
*   **自動指派**：系統會根據預設規則（例如最少工作量）自動指派。
    ```
    !auto_assign <ticket_id>
    ```

### 設定票券優先級

您可以根據票券的緊急程度設定其優先級。

```
/set_priority [priority: high|medium|low] [ticket_id: 票券ID]
```

### 標籤管理

標籤有助於分類和搜尋票券。

*   **創建標籤**：
    ```
    !tag create <name> <display_name>
    ```
*   **刪除標籤**：
    ```
    !tag delete <name>
    ```
*   **初始化預設標籤**：
    ```
    !tag init
    ```
*   **為票券添加標籤**：
    ```
    /add_tag <tag_name> [ticket_id: 票券ID]
    ```

### 統計與報告

票券系統提供多種統計數據和報告，幫助您監控服務品質和團隊績效。

*   **票券統計概覽**：
    ```
    /ticket_stats
    ```
*   **實時統計**：
    ```
    /realtime_stats
    ```
*   **優先級統計**：
    ```
    !priority_stats [days: 天數]
    ```
*   **客服工作量**：
    ```
    !staff_workload [@客服人員]
    ```
*   **指派統計**：
    ```
    !assignment_stats [days: 天數]
    ```
*   **生成摘要報告**：
    ```
    !report [days: 天數]
    ```
*   **顯示統計面板**：
    ```
    !dashboard [days: 天數]
    ```

## ⚙️ 自動化與智能功能

*   **SLA 監控**：系統會自動追蹤票券的回應時間，並在超時時發出警告。
*   **自動關閉**：無活動的票券會根據設定的時間自動關閉。
*   **成員離開處理**：當票券創建者離開伺服器時，其開啟中的票券會自動關閉。
*   **智能優先級**：AI 可以根據票券內容自動評估和設定優先級。
*   **智能標籤**：AI 可以根據票券內容推薦相關標籤。
*   **自動指派**：系統可以根據客服的工作量或專精自動指派票券。
*   **聊天記錄匯出**：票券關閉時，聊天記錄會自動匯出。

## 🛠️ 配置選項

票券系統的行為可以透過多種設定進行客製化。

*   **查看系統設定**：
    ```
    !ticket_settings
    ```
*   **主要設定**：
    *   `max_tickets_per_user`：每個用戶可以同時開啟的最大票券數量。
    *   `auto_close_hours`：票券無活動後自動關閉的小時數。
    *   `sla_response_minutes`：預期的首次回應時間（分鐘）。
    *   `welcome_message`：票券頻道中的歡迎訊息。
    *   `support_roles`：被視為客服人員的角色 ID 列表。
    *   `category_id`：新票券頻道將被創建的分類 ID。

## 🔗 API 整合

票券系統提供 RESTful API 端點，允許外部應用程式與票券數據進行互動。

### API 端點概覽

*   `GET /api/v1/tickets`：獲取票券列表。
*   `GET /api/v1/tickets/{ticket_id}`：獲取特定票券詳情。
*   `POST /api/v1/tickets`：創建新票券。
*   `PUT /api/v1/tickets/{ticket_id}`：更新票券信息（狀態、優先級、指派等）。
*   `DELETE /api/v1/tickets/{ticket_id}`：刪除票券（軟刪除）。
*   `POST /api/v1/tickets/{ticket_id}/close`：關閉票券。
*   `POST /api/v1/tickets/{ticket_id}/assign`：指派票券。
*   `POST /api/v1/tickets/{ticket_id}/rating`：為票券評分。
*   `GET /api/v1/tickets/statistics/overview`：獲取票券統計概覽。
*   `GET /api/v1/tickets/statistics`：獲取公開票券統計（無需認證）。
